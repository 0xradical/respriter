BEGIN;

CREATE TABLE app.course_categories (
  id                uuid        DEFAULT public.uuid_generate_v4() PRIMARY KEY,
  parent_id         uuid        REFERENCES app.course_categories(id),
  key               varchar,
  created_at        timestamptz DEFAULT NOW() NOT NULL,
  updated_at        timestamptz DEFAULT NOW() NOT NULL
);

ALTER TABLE app.courses ADD COLUMN course_category_id uuid REFERENCES app.course_categories(id) ON DELETE SET NULL;

CREATE INDEX index_course_categories_on_parent_id
ON app.course_categories
USING btree (parent_id);

CREATE INDEX index_course_categories_on_key
ON app.course_categories
USING btree (key);

CREATE INDEX index_courses_on_course_category_id
ON app.courses
USING btree (course_category_id);

INSERT INTO app.course_categories (id, key, parent_id) VALUES
('9a65c472-4d90-4aed-8bc3-310b568794e7', 'it_computer_science',        null),
('c4aa25cf-b620-4184-a58f-fda4ed3d226e', 'arts_design',                null),
('2e83ea36-b85e-458e-9a47-a1fe754be697', 'health_medicine',            null),
('dc9eb925-adde-4d09-82a6-21738c2d0cbe', 'fitness',                    null),
('7c7cf40b-b870-40a5-8eaf-77f07cdef44d', 'humanities_social_sciences', null),
('336848b9-e6c1-49e4-8700-b376e383ad83', 'business',                   null),
('f23103d3-0468-4913-8ffe-f7b9728db708', 'finance',                    null),
('41803785-ac43-4106-92e0-8fef240f6f73', 'marketing',                  null),
('83ab1f33-0c82-4e59-8032-76fae6c13780', 'personal_development',       null),
('c0831a16-1280-4544-a478-1e35d2acd6b6', 'math_science_engineering',   null),
('cef83fd8-3c87-4a8a-9d81-d63b9fe71901', 'languages',                  null),
('8b91c17f-51ee-4ced-87ec-89541611c643', 'professions_hobbies',        null);

INSERT INTO app.course_categories (key, parent_id) VALUES
('software_development',               '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('web_development',                    '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('mobile_development',                 '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('algorithms',                         '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('machine_learning',                   '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('data_analysis_visualization',        '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('network_security',                   '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('cloud_computing',                    '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('it_certifications',                  '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('it_operations_devops',               '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('operating_systems',                  '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('databases',                          '9a65c472-4d90-4aed-8bc3-310b568794e7'),
('photography',                        'c4aa25cf-b620-4184-a58f-fda4ed3d226e'),
('music',                              'c4aa25cf-b620-4184-a58f-fda4ed3d226e'),
('film_video',                         'c4aa25cf-b620-4184-a58f-fda4ed3d226e'),
('web_design',                         'c4aa25cf-b620-4184-a58f-fda4ed3d226e'),
('visual_arts',                        'c4aa25cf-b620-4184-a58f-fda4ed3d226e'),
('graphic_design',                     'c4aa25cf-b620-4184-a58f-fda4ed3d226e'),
('product_design',                     'c4aa25cf-b620-4184-a58f-fda4ed3d226e'),
('fashion',                            'c4aa25cf-b620-4184-a58f-fda4ed3d226e'),
('game_design',                        'c4aa25cf-b620-4184-a58f-fda4ed3d226e'),
('architecture_interior_design',       'c4aa25cf-b620-4184-a58f-fda4ed3d226e'),
('software_tools',                     'c4aa25cf-b620-4184-a58f-fda4ed3d226e'),
('health_care',                        '2e83ea36-b85e-458e-9a47-a1fe754be697'),
('nutrition',                          '2e83ea36-b85e-458e-9a47-a1fe754be697'),
('diseases_disorders',                 '2e83ea36-b85e-458e-9a47-a1fe754be697'),
('meditation',                         '2e83ea36-b85e-458e-9a47-a1fe754be697'),
('mental_health',                      '2e83ea36-b85e-458e-9a47-a1fe754be697'),
('public_health',                      '2e83ea36-b85e-458e-9a47-a1fe754be697'),
('anatomy',                            '2e83ea36-b85e-458e-9a47-a1fe754be697'),
('yoga',                               'dc9eb925-adde-4d09-82a6-21738c2d0cbe'),
('sports',                             'dc9eb925-adde-4d09-82a6-21738c2d0cbe'),
('dance',                              'dc9eb925-adde-4d09-82a6-21738c2d0cbe'),
('self_defense',                       'dc9eb925-adde-4d09-82a6-21738c2d0cbe'),
('history',                            '7c7cf40b-b870-40a5-8eaf-77f07cdef44d'),
('political_science_government',       '7c7cf40b-b870-40a5-8eaf-77f07cdef44d'),
('law',                                '7c7cf40b-b870-40a5-8eaf-77f07cdef44d'),
('philosophy',                         '7c7cf40b-b870-40a5-8eaf-77f07cdef44d'),
('communication_journalism',           '7c7cf40b-b870-40a5-8eaf-77f07cdef44d'),
('economics',                          '7c7cf40b-b870-40a5-8eaf-77f07cdef44d'),
('literature',                         '7c7cf40b-b870-40a5-8eaf-77f07cdef44d'),
('psychology',                         '7c7cf40b-b870-40a5-8eaf-77f07cdef44d'),
('sociology',                          '7c7cf40b-b870-40a5-8eaf-77f07cdef44d'),
('geography',                          '7c7cf40b-b870-40a5-8eaf-77f07cdef44d'),
('entrepreneurship',                   '336848b9-e6c1-49e4-8700-b376e383ad83'),
('leadership_management',              '336848b9-e6c1-49e4-8700-b376e383ad83'),
('business_intelligence_analytics',    '336848b9-e6c1-49e4-8700-b376e383ad83'),
('sales',                              '336848b9-e6c1-49e4-8700-b376e383ad83'),
('project_management',                 '336848b9-e6c1-49e4-8700-b376e383ad83'),
('communication',                      '336848b9-e6c1-49e4-8700-b376e383ad83'),
('human_resources',                    '336848b9-e6c1-49e4-8700-b376e383ad83'),
('customer_service',                   '336848b9-e6c1-49e4-8700-b376e383ad83'),
('home_business',                      '336848b9-e6c1-49e4-8700-b376e383ad83'),
('software_tools',                     '336848b9-e6c1-49e4-8700-b376e383ad83'),
('accounting_bookkeeping',             'f23103d3-0468-4913-8ffe-f7b9728db708'),
('investing_trading',                  'f23103d3-0468-4913-8ffe-f7b9728db708'),
('crypto_blockchain',                  'f23103d3-0468-4913-8ffe-f7b9728db708'),
('finance_certification',              'f23103d3-0468-4913-8ffe-f7b9728db708'),
('seo',                                '41803785-ac43-4106-92e0-8fef240f6f73'),
('social_media',                       '41803785-ac43-4106-92e0-8fef240f6f73'),
('affiliate_marketing',                '41803785-ac43-4106-92e0-8fef240f6f73'),
('content_marketing',                  '41803785-ac43-4106-92e0-8fef240f6f73'),
('email_marketing',                    '41803785-ac43-4106-92e0-8fef240f6f73'),
('branding',                           '41803785-ac43-4106-92e0-8fef240f6f73'),
('career_interviewing',                '83ab1f33-0c82-4e59-8032-76fae6c13780'),
('productivity',                       '83ab1f33-0c82-4e59-8032-76fae6c13780'),
('personal_finance',                   '83ab1f33-0c82-4e59-8032-76fae6c13780'),
('creativity',                         '83ab1f33-0c82-4e59-8032-76fae6c13780'),
('memory_study_skills',                '83ab1f33-0c82-4e59-8032-76fae6c13780'),
('communication_skills',               '83ab1f33-0c82-4e59-8032-76fae6c13780'),
('public_speaking',                    '83ab1f33-0c82-4e59-8032-76fae6c13780'),
('religion_spirituality',              '83ab1f33-0c82-4e59-8032-76fae6c13780'),
('parenting_relationships',            '83ab1f33-0c82-4e59-8032-76fae6c13780'),
('emotional_intelligence',             '83ab1f33-0c82-4e59-8032-76fae6c13780'),
('electrical_engineering_electronics', 'c0831a16-1280-4544-a478-1e35d2acd6b6'),
('mechanical_engineering',             'c0831a16-1280-4544-a478-1e35d2acd6b6'),
('civil_engineering',                  'c0831a16-1280-4544-a478-1e35d2acd6b6'),
('mathematics',                        'c0831a16-1280-4544-a478-1e35d2acd6b6'),
('physics',                            'c0831a16-1280-4544-a478-1e35d2acd6b6'),
('biology',                            'c0831a16-1280-4544-a478-1e35d2acd6b6'),
('chemistry',                          'c0831a16-1280-4544-a478-1e35d2acd6b6'),
('environmental_science',              'c0831a16-1280-4544-a478-1e35d2acd6b6'),
('general_science',                    'c0831a16-1280-4544-a478-1e35d2acd6b6'),
('english_language',                   'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('english_grammar',                    'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('english_conversation',               'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('english_for_business',               'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('chinese_language',                   'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('spanish_language',                   'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('french_language',                    'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('german_language',                    'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('japanese_language',                  'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('arabic_language',                    'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('italian_language',                   'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('korean_language',                    'cef83fd8-3c87-4a8a-9d81-d63b9fe71901'),
('teaching_education',                 '8b91c17f-51ee-4ced-87ec-89541611c643'),
('real_estate',                        '8b91c17f-51ee-4ced-87ec-89541611c643'),
('crafts',                             '8b91c17f-51ee-4ced-87ec-89541611c643'),
('food_beverage',                      '8b91c17f-51ee-4ced-87ec-89541611c643'),
('beauty_makeup',                      '8b91c17f-51ee-4ced-87ec-89541611c643'),
('travel',                             '8b91c17f-51ee-4ced-87ec-89541611c643'),
('gaming',                             '8b91c17f-51ee-4ced-87ec-89541611c643');

INSERT INTO public.schema_migrations (version) VALUES ('20200803211853');

COMMIT;
