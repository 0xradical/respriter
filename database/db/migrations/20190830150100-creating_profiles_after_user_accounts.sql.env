BEGIN;

CREATE OR REPLACE FUNCTION triggers.create_profile_for_user_account() RETURNS trigger
AS $$
BEGIN
  INSERT INTO api.profiles (user_account_id) VALUES (NEW.id);
  RETURN NEW;
END
$$ SECURITY DEFINER LANGUAGE plpgsql;

CREATE TRIGGER create_profile_for_user_account
  AFTER INSERT
  ON api.user_accounts
  FOR EACH ROW
    EXECUTE PROCEDURE triggers.create_profile_for_user_account();

INSERT INTO public.schema_migrations (version) VALUES ('20190830150100');

COMMIT;
