#!/bin/bash

# extract the protocol
proto="$(echo $1 | grep :// | sed -e's,^\(.*://\).*,\1,g')"

# remove the protocol
url="$(echo ${1/$proto/})"

# extract the user (if any)
user_and_password="$(echo $url | grep @ | cut -d@ -f1)"
user="$(echo $user_and_password | grep : | cut -d: -f1)"
password="$(echo $user_and_password | grep : | cut -d: -f2)"

# extract the host and port
hostport="$(echo ${url/$user_and_password@/} | cut -d/ -f1)"

# by request host without port    
host="$(echo $hostport | sed -e 's,:.*,,g')"

# by request - try to extract the port
port="$(echo $hostport | sed -e 's,^.*:,:,g' -e 's,.*:\([0-9]*\).*,\1,g' -e 's,[^0-9],,g')"

# extract the path (if any)
fullpath="$(echo $url | grep / | cut -d/ -f2-)"

# extract the path (if any)
path="$(echo $fullpath | cut -d\? -f1)"

case $2 in
proto)
  echo $proto | cut -d: -f1
  exit 0
  ;;
user)
  echo $user
  exit 0
  ;;
password)
  echo $password
  exit 0
  ;;
user_and_password)
  echo $user_and_password
  exit 0
  ;;
host)
  echo $host
  exit 0
  ;;
port)
  echo $port
  exit 0
  ;;
fullpath)
  echo $fullpath
  exit 0
  ;;
path)
  echo $path
  exit 0
  ;;
*)
  echo "url: $url"
  echo "  proto:             $proto"
  echo "  user:              $user"
  echo "  password:          $password"
  echo "  user_and_password: $user_and_password"
  echo "  host:              $host"
  echo "  port:              $port"
  echo "  path:              $path"
  echo "  fullpath:          $fullpath"
  ;;
esac
