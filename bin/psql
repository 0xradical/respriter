#!/usr/bin/env bash

tty_flag=""
if [ $# -eq 0 ]; then
  env_file="envs/dev/database.env"
else
  env_file=`./bin/database_alias $1`
  if [ $# -eq 1 ]; then
    tty_flag="t"
  fi
fi

if [ -p /dev/stdin ] ; then
  tty_flag=""
fi

flags="--rm -i$tty_flag --env-file ./$env_file -v `pwd`:/repo -w /repo --network classpert"
docker run $flags postgres:11.4-alpine sh -c "psql \$(echo \$POSTGRES_URL | sed 's/?.*//g') `echo ${@:2}`"
