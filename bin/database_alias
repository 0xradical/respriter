#!/usr/bin/env bash

env=`echo $1 | rev | cut -d- -f 1 | rev`
if [[ ! "$env" = "prd" && ! "$env" = "stg" ]]; then
  env='dev'
fi

contains() {
    [[ $1 =~ (^|[[:space:]])$2($|[[:space:]]) ]] && echo "yes" || echo "no"
}

name=`echo $1 | sed -E "s/-(dev|stg|prd|test)$//g" | sed "s/[-_]/./g"`

res=`contains "base web.app app worker que ssr webpack database api user.app user developer.app developer indextool" $name`
if [ $res = "yes" ] ; then
  echo "envs/$env/database.env"
  exit 0
fi

res=`contains "napoleon database.napoleon napoleon.database napoleon.api api.napoleon worker.napoleon napoleon.worker" $name`
if [ $res = "yes" ] ; then
  echo "envs/$env/database-napoleon.env"
  exit 0
fi

res=`contains "dev stg prd test" $1`
if [ $res = "yes" ] ; then
  echo "envs/$1/database-napoleon.env"
  exit 0
fi

echo "Could not identify database"
exit -1
